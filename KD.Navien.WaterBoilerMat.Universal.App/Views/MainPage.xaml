<Page x:Class="KD.Navien.WaterBoilerMat.Universal.App.Views.MainPage"
	  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	  xmlns:local="using:KD.Navien.WaterBoilerMat.Universal.App.Views"
	  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	  xmlns:prismMvvm="using:Prism.Windows.Mvvm"
	  mc:Ignorable="d"
	  prismMvvm:ViewModelLocator.AutoWireViewModel="True"
	  Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
		<StackPanel>
			<Button Content="Scan" Command="{Binding ScanCommand}" />
			<ListView x:Name="deviceList" Header="Device List" ItemsSource="{Binding FoundDevices}">
				<ListView.ItemTemplate>
					<DataTemplate>
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition />
								<ColumnDefinition />
							</Grid.ColumnDefinitions>

							<TextBlock Grid.Column="0" Text="{Binding Name}"/>
							<TextBlock Grid.Column="1" Text="{Binding Address}"/>
						</Grid>
					</DataTemplate>
				</ListView.ItemTemplate>
			</ListView>
			<Button Content="Connect" Command="{Binding ConnectCommand}" CommandParameter="{Binding ElementName=deviceList, Path=SelectedItem}"/>
			<TextBlock Text="{Binding ElementName=deviceList, Path=SelectedItem.IsReadyForBoilerService}"/>
			<!--<Label Text="{Binding Source={x:Reference deviceList}, SelectedItem.IsReadyForBoilerService}, StringFormat='IsReadyForBoilerService : [{0}]'}"/>-->
			<ListView x:Name="serviceList" Header="GattService List" ItemsSource="{Binding ElementName=deviceList, Path=SelectedItem.Services}">
				<ListView.ItemTemplate>
					<DataTemplate>
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition />
								<ColumnDefinition />
							</Grid.ColumnDefinitions>

							<TextBlock Grid.Column="0" Text="{Binding Name}"/>
							<TextBlock Grid.Column="1" Text="{Binding UUID}"/>
						</Grid>
					</DataTemplate>
				</ListView.ItemTemplate>
			</ListView>
			<ListView x:Name="characteristicList" Header="Characteristic List" ItemsSource="{Binding ElementName=serviceList, Path=SelectedItem.GattCharacteristics}">
				<ListView.ItemTemplate>
					<DataTemplate>
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition />
								<ColumnDefinition />
							</Grid.ColumnDefinitions>

							<TextBlock Grid.Column="0" Text="{Binding Name}"/>
							<TextBlock Grid.Column="1" Text="{Binding UUID}"/>
						</Grid>
					</DataTemplate>
				</ListView.ItemTemplate>
			</ListView>
			<Button Content="Debug" Command="{Binding DebugCommand}" />
		</StackPanel>
	</Grid>
</Page>
